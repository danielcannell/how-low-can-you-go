[gd_scene load_steps=9 format=2]

[ext_resource path="res://Art/jelly.png" type="Texture" id=1]
[ext_resource path="res://Enemies/Jelly.gd" type="Script" id=2]
[ext_resource path="res://Art/jelly-bio.png" type="Texture" id=3]

[sub_resource type="CapsuleShape2D" id=1]
radius = 28.2125
height = 32.7649

[sub_resource type="Shader" id=2]
code = "shader_type canvas_item;

void vertex() {
    VERTEX.x += 2.5 * UV.y * sin(2.0 * (TIME + UV.y * 0.2));
}

void fragment() {
    //COLOR = texture(TEXTURE, UV);
    //float phase = sin(4.0*(UV.y*5.0 + TIME));
    //float intensity = pow((1.0 + sin(phase)) / 2.0, 2.0);
    //COLOR.xyz *= intensity;
}

void light() {
    float phase = sin(4.0*(UV.y*5.0 + TIME));
    float intensity = pow((1.0 + sin(phase)) / 2.0, 2.0);
    LIGHT.y *= intensity;
}

"

[sub_resource type="ShaderMaterial" id=3]
shader = SubResource( 2 )

[sub_resource type="Shader" id=4]
code = "shader_type canvas_item;

uniform sampler2D depthmap;

void light () {

LIGHT = LIGHT*(1.0-texture(depthmap,UV).r);
LIGHT_HEIGHT = (100.0-texture(depthmap,UV).r*200.0);
}"

[sub_resource type="ShaderMaterial" id=5]
shader = SubResource( 4 )

[node name="Node2D" type="KinematicBody2D"]
script = ExtResource( 2 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource( 1 )

[node name="Sprite" type="Sprite" parent="."]
material = SubResource( 3 )
texture = ExtResource( 1 )

[node name="Light2D" type="Light2D" parent="."]
material = SubResource( 5 )
position = Vector2( -0.375, 0 )
texture = ExtResource( 3 )
color = Color( 0.16, 0.87, 0.570469, 1 )
energy = 1.06
